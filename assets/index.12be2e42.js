import{c as j,j as S,r as T,k as N,R as w,a as C}from"./vendor.898d167f.js";const L=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function u(t){if(t.ep)return;t.ep=!0;const i=d(t);fetch(t.href,i)}};L();const h=j(o=>({todos:[],selectedTodo:{},deletedTodo:{},setTodos:e=>o({todos:e}),addTodo:e=>o(d=>({todos:[...d.todos,e]})),insertTodo:(e,d)=>o(u=>({todos:[...u.todos.slice(0,d),e,...u.todos.slice(d)]})),removeTodo:e=>o(d=>({deletedTodo:d.todos.find(t=>t.id===e),todos:d.todos.filter(t=>t.id!==e)})),selectTodo:e=>o(d=>({selectedTodo:e?d.todos.find(u=>u.id===e):{}})),updateSelectedText:e=>o(d=>d.selectedTodo.text=e)})),l=S.exports.jsx,v=S.exports.jsxs;var B=T.exports.forwardRef(({todo:o,setCompleted:e},d)=>{const u=h(n=>n.selectTodo),[t,i]=T.exports.useState(o.completed_at?new Date(o.completed_at):null),m=t!==null,r=()=>{const n=!m;return o.completed_at=n?new Date:null,e(a=>{const p=a.findIndex(g=>o.id===g.id);return n&&p===-1?[...a,o]:!n&&p!==-1?a.filter(g=>o.id!==g.id):a}),i(o.completed_at)},c=n=>n?`${n.toLocaleString()}`:"",f=n=>{n.preventDefault(),u(o.id)};return l("li",{children:v("div",{className:"todo-item",children:[l("button",{ref:d,tabIndex:"0","data-id":o.id,onClick:r,onContextMenu:f,className:`item-text ${m&&"completed"}`,children:o.text}),l("small",{className:"completed-at",children:c(t)})]})})});function U({input:o,todoRefs:e}){function d(r){return r.target.blur()}function u(r){var c;if(r.target.tagName==="BUTTON"){const f=parseInt((c=r.target.dataset)==null?void 0:c.id,10);return f?(r.preventDefault(),h.setState({selectedTodo:h.getState().todos.find(n=>n.id===f)}),o==null?void 0:o.current.focus()):void 0}if(r.target.tagName!=="INPUT")return r.preventDefault(),o==null?void 0:o.current.focus()}function t(r){var c;if(r.target.tagName==="BUTTON"){r.preventDefault();const f=h.getState().deletedTodo;if(!f.id)return;const n=parseInt((c=r.target.dataset)==null?void 0:c.id,10),a=(h.getState().todos.findIndex(g=>g.id===n)||0)+!r.shiftKey,p=h.getState().todos;return h.setState({deletedTodo:{},todos:[...p.slice(0,a),f,...p.slice(a)]})}}function i(r){var c,f,n,a;if(r.target.tagName==="BUTTON"){r.preventDefault();const p=e.current.findIndex(g=>g===r.target);return(f=(c=e.current)==null?void 0:c[p+1])==null?void 0:f.focus()}if(r.target.tagName!=="INPUT")return r.preventDefault(),(a=(n=e.current)==null?void 0:n[0])==null?void 0:a.focus()}function m(r){var c,f,n,a;if(r.target.tagName==="BUTTON"){r.preventDefault();const p=e.current.findIndex(g=>g===r.target);return(f=(c=e.current)==null?void 0:c[p-1])==null?void 0:f.focus()}if(r.target.tagName!=="INPUT")return r.preventDefault(),(a=(n=e.current)==null?void 0:n[e.current.length-1])==null?void 0:a.focus()}return[()=>{N.bind("esc",d),N.bind("i",u),N.bind(["p","shift + p"],t),N.bind("j",i),N.bind("k",m)},()=>N.reset()]}function M(){const[o,e]=T.exports.useState(""),[d,u]=T.exports.useState([]),t=T.exports.useRef(null),i=T.exports.useRef([]),[m,r,c,f]=h(s=>[s.todos,s.setTodos,s.selectedTodo,s.deletedTodo]),n=()=>localStorage.setItem("todos",JSON.stringify(m)),[a,p,g,I]=h(s=>[s.addTodo,s.removeTodo,s.updateSelectedText,s.selectTodo]),[b,y]=U({input:t,todoRefs:i});T.exports.useEffect(()=>{var s;return r(((s=JSON.parse(localStorage.getItem("todos")))!=null?s:[]).filter(x=>x.id)),b(),()=>y()},[]),T.exports.useEffect(()=>{e(c.text),t.current.focus()},[c.id]),T.exports.useEffect(n,[m,d]);const D=s=>a({id:Date.now(),text:s,completed_at:null});return v("div",{className:"columns",children:[v("div",{className:"column",children:[l("h1",{children:"TODO List"}),l("form",{onSubmit:s=>{s.preventDefault();const x=o;if(e(""),c.id)return x.length?(g(x),n()):p(c.id),I(null);if(!!x)return t.current.focus(),D(x)},children:l("fieldset",{children:l("div",{children:l("input",{ref:t,className:"input",placeholder:c.id?"Press enter to delete":"New item",onInput:s=>e(s.target.value),value:o||""})})})}),l("ul",{className:"todo-list",children:m.map((s,x)=>l(B,{ref:O=>i.current[x]=O,todo:s,setCompleted:u},s.id))})]}),v("div",{className:"column summary",children:[l("h2",{children:"Summary"}),v("p",{children:["Completed: ",l("strong",{children:d.length})]}),v("p",{children:["Not completed: ",l("strong",{children:m.length-d.length})]})]})]})}function P(){return l(M,{})}w.render(l(C.StrictMode,{children:l(P,{})}),document.getElementById("root"));
